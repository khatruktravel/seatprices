<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ØªØ­Ø¯ÙŠØ« Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø·ÙŠØ±Ø§Ù† - Ø®Ø§Ø·Ø±Ùƒ</title>
  <meta name="description" content="Ù†Ø¸Ø§Ù… ØªØ­Ø¯ÙŠØ« Ø£Ø³Ø¹Ø§Ø± ØªØ°Ø§ÙƒØ± Ø§Ù„Ø·ÙŠØ±Ø§Ù† - Ø®Ø§Ø·Ø±Ùƒ Ù„Ù„Ø³ÙØ±ÙŠØ§Øª ÙˆØ§Ù„Ø³ÙŠØ§Ø­Ø©">
  <meta name="theme-color" content="#0a1d90">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="https://i.postimg.cc/XYgg7c0D/Logo-Yemenia.png
  " type="image/png">
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js
  "></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: white;
      color: #0a1d90;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 2px solid #0a1d90;
      position: relative;
    }
    .header-content {
      flex: 1;
      text-align: center;
      z-index: 1;
    }
    .header h1 {
      margin: 0;
      font-size: 19px;
      font-weight: bold;
      color: #0a1d90;
    }
    .header p {
      margin: 10px 0 0;
      font-size: 16px;
      color: #ff3007;
      font-weight: bold;
    }
    .header-img {
      height: 70px;
      width: auto;
      object-fit: contain;
      margin: 0 60px;
    }
    .controls {
      padding: 15px;
      background: #e3f2fd;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      border-bottom: 1px solid #ddd;
    }
    .controls select, .controls input, .controls button {
      padding: 10px;
      font-size: 16px;
      border: 1px solid #0055aa;
      border-radius: 8px;
    }
    .controls button {
      background: #003366;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    .controls button:hover {
      background: #002244;
    }
    .controls button.add {
      background: #28a745;
    }
    .controls button.add:hover {
      background: #218838;
    }
    .controls button.print {
      background: #007bff;
    }
    .controls button.clear {
      background: #dc3545;
    }
    .controls button.clear:hover {
      background: #c82333;
    }
    .controls button.download {
      background: #ffc107;
      color: #003366;
    }
    .controls button.download:hover {
      background: #e0a800;
    }
    .controls button.text {
      background: #6f42c1;
      color: white;
    }
    .controls button.text:hover {
      background: #5a2d9c;
    }
    .controls .quantity {
      width: 80px;
      text-align: center;
    }
    .content {
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 8px;
      font-size: 16px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-radius: 15px;
      overflow: hidden;
    }
    th {
      background: linear-gradient(1deg, #005cb2, #003a7d);
      color: white;
      padding: 14px;
      text-align: center;
      border-radius: 15px 15px 0 0;
      border-bottom: 3px solid #ff0000;
    }
    td {
      padding: px;
      text-align: center;
      background-color: white;
      border-radius: 12px;
      box-shadow: -1px -1px 8px 0px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
    }
    td:hover {
      background-color: #f8f9fa;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    tr:nth-child(even) {
      background: #f8f9fa;
    }
    .one-way {
      color: #28a745;
      font-weight: bold;
      font-size: 17px;
    }
    .return {
      color: #003366;
      font-weight: bold;
      font-size: 17px;
    }
    .date-bold {
      font-weight: bold;
      font-size: 17px;
    }
    .day-bold {
      font-weight: bold;
      font-size: 17px;
    }
    .editable {
      cursor: pointer;
      position: relative;
    }
    .editable:focus {
      outline: 2px solid #0055aa;
      border-radius: 8px;
      background-color: #f0f8ff;
    }
    .delete-btn {
      color: #ef4444;
      font-size: 24px;
      line-height: 1;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    .delete-btn:hover {
      color: #dc2626;
    }
    .delete-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }
    .footer {
      text-align: center;
      padding: 8px;
      background: linear-gradient(
179deg, #005cb2, #0b2d55);
      color: white;
      font-size: 21px;
      font-weight: bold;
    }
    .footer a {
      color: #ffc107;
      text-decoration: none;
      font-weight: bold;
      font-size: 22px;
    }
    .footer a:hover {
      text-decoration: underline;
    }
    .timestamp {
      text-align: center;
      font-size: 19px;
      color: #003366;
      padding: 6px;
      background: #f8f9fa;
      font-weight: bold;
      border-top: 0px solid #003366;
      border-bottom: 2px solid #003366;
    }
    @media print {
      .controls, .no-print {
        display: none !important;
      }
      .delete-header, .delete-column {
        display: none !important;
      }
    }
    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        text-align: center;
      }
      .header-img {
        margin: 10px 0;
        height: 70px;
      }
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
    }
  </style>
</head>
<body>
  <div class="container" id="print-area">
    <div class="header">
      <img src="https://i.postimg.cc/XYgg7c0D/Logo-Yemenia.png
  " alt="Ø´Ø¹Ø§Ø± Ø®Ø§Ø·Ø±Ùƒ Ù„Ù„Ø³ÙØ±ÙŠØ§Øª" class="header-img">
      <div class="header-content">
        <h1>Ø®Ø§Ø·Ø±Ùƒ Ù„Ù„Ø³ÙØ±ÙŠØ§Øª ÙˆØ§Ù„Ø³ÙŠØ§Ø­Ø© ÙˆØ§Ù„Ø­Ø¬ ÙˆØ§Ù„Ø¹Ù…Ø±Ø©</h1>
        <p>Ø£Ø³Ø¹Ø§Ø± ØªØ°Ø§ÙƒØ± Ø·ÙŠØ±Ø§Ù† Ø§Ù„ÙŠÙ…Ù†ÙŠØ© - ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø±</p>
      </div>
      <img src="https://i.postimg.cc/Dy9rcp7N/512.png
  " alt="Ø´Ø¹Ø§Ø± Ø¥Ø¶Ø§ÙÙŠ" class="header-img">
    </div>
    <div class="controls no-print">
      <select id="from-city" required>
        <option value="">Ù…Ù†</option>
        <option value="Ø¹Ø¯Ù†-ADE">Ø¹Ø¯Ù†-ADE</option>
        <option value="Ø³ÙŠØ¦ÙˆÙ†-GXF">Ø³ÙŠØ¦ÙˆÙ†-GXF</option>
        <option value="Ø§Ù„Ø±ÙŠØ§Ù†-RIY">Ø§Ù„Ø±ÙŠØ§Ù†-RIY</option>
        <option value="Ø§Ù„ØºÙŠØ¶Ø©-AAY">Ø§Ù„ØºÙŠØ¶Ø©-AAY</option>
        <option value="Ø³Ù‚Ø·Ø±Ù‰-SCT">Ø³Ù‚Ø·Ø±Ù‰-SCT</option>
        <option value="ØµÙ†Ø¹Ø§Ø¡-SAH">ØµÙ†Ø¹Ø§Ø¡-SAH</option>
        <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©-CAI">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©-CAI</option>
        <option value="Ø¹Ù…Ø§Ù†-AMM">Ø¹Ù…Ø§Ù†-AMM</option>
        <option value="Ø¬Ø¯Ø©-JED">Ø¬Ø¯Ø©-JED</option>
        <option value="Ø§Ù„Ø±ÙŠØ§Ø¶-RUH">Ø§Ù„Ø±ÙŠØ§Ø¶-RUH</option>
        <option value="Ø¯Ø¨ÙŠ-DXB">Ø¯Ø¨ÙŠ-DXB</option>
        <option value="Ø§Ù„ÙƒÙˆÙŠØª-KWI">Ø§Ù„ÙƒÙˆÙŠØª-KWI</option>
        <option value="Ø¬ÙŠØ¨ÙˆØªÙŠ-JIB">Ø¬ÙŠØ¨ÙˆØªÙŠ-JIB</option>
        <option value="Ø§Ø¯ÙŠØ³-ADD">Ø§Ø¯ÙŠØ³-ADD</option>
        <option value="Ù…ÙˆÙ…Ø¨Ø§ÙŠ-BOM">Ù…ÙˆÙ…Ø¨Ø§ÙŠ-BOM</option>
      </select>
      <select id="to-city" required>
        <option value="">Ø¥Ù„Ù‰</option>
        <option value="Ø¹Ø¯Ù†-ADE">Ø¹Ø¯Ù†-ADE</option>
        <option value="Ø³ÙŠØ¦ÙˆÙ†-GXF">Ø³ÙŠØ¦ÙˆÙ†-GXF</option>
        <option value="Ø§Ù„Ø±ÙŠØ§Ù†-RIY">Ø§Ù„Ø±ÙŠØ§Ù†-RIY</option>
        <option value="Ø§Ù„ØºÙŠØ¶Ø©-AAY">Ø§Ù„ØºÙŠØ¶Ø©-AAY</option>
        <option value="Ø³Ù‚Ø·Ø±Ù‰-SCT">Ø³Ù‚Ø·Ø±Ù‰-SCT</option>
        <option value="ØµÙ†Ø¹Ø§Ø¡-SAH">ØµÙ†Ø¹Ø§Ø¡-SAH</option>
        <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©-CAI">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©-CAI</option>
        <option value="Ø¹Ù…Ø§Ù†-AMM">Ø¹Ù…Ø§Ù†-AMM</option>
        <option value="Ø¬Ø¯Ø©-JED">Ø¬Ø¯Ø©-JED</option>
        <option value="Ø§Ù„Ø±ÙŠØ§Ø¶-RUH">Ø§Ù„Ø±ÙŠØ§Ø¶-RUH</option>
        <option value="Ø¯Ø¨ÙŠ-DXB">Ø¯Ø¨ÙŠ-DXB</option>
        <option value="Ø§Ù„ÙƒÙˆÙŠØª-KWI">Ø§Ù„ÙƒÙˆÙŠØª-KWI</option>
        <option value="jÙŠØ¨ÙˆØªÙŠ-JIB">Ø¬ÙŠØ¨ÙˆØªÙŠ-JIB</option>
        <option value="Ø§Ø¯ÙŠØ³-ADD">Ø§Ø¯ÙŠØ³-ADD</option>
        <option value="Ù…ÙˆÙ…Ø¨Ø§ÙŠ-BOM">Ù…ÙˆÙ…Ø¨Ø§ÙŠ-BOM</option>
      </select>
      <input type="date" id="flight-date" required />
      <input type="number" id="one-way-price" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø°Ù‡Ø§Ø¨ ÙÙ‚Ø·" />
      <input type="number" id="return-price" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø°Ù‡Ø§Ø¨ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø©" />
      <input type="text" id="notes" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
      <input type="number" id="quantity" class="quantity" min="1" max="30" value="1" placeholder="Ø¹Ø¯Ø¯">
      <button onclick="addFlight()" class="add">â• Ø¥Ø¶Ø§ÙØ© Ø±Ø­Ù„Ø©</button>
      <button onclick="clearTable()" class="clear">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
      <button onclick="window.print()" class="print">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
      <button onclick="downloadImage()" class="download">ğŸ’¾ ØªÙ†Ø²ÙŠÙ„ ÙƒØµÙˆØ±Ø©</button>
      <button onclick="downloadText()" class="text">ğŸ“ ØªÙ†Ø²ÙŠÙ„ ÙƒÙ…Ù„Ù Ù†ØµÙŠ</button>
    </div>
    <div class="timestamp" id="timestamp">
      Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« : 03/09/2025 & Ø§Ù„Ø³Ø§Ø¹Ø©: [03:47] Øµ
    </div>
    <div class="content">
      <table id="flights-table">
        <thead>
          <tr>
            <th>Ø§Ù„ÙŠÙ€Ù€Ù€ÙˆÙ…</th>
            <th style="
    padding-left: 14px;
    padding-right: 14px;
">Ø§Ù„ØªÙ€Ù€Ù€Ø§Ø±ÙŠÙ€Ù€Ø®</th>
            <th style="
    padding-left: 10px;
    padding-right: 10px;
    width: 99.406;
">Ø§Ù„Ø¥Ù‚Ù€Ù€Ù€Ù€Ù€Ù€Ù„Ø§Ø¹ Ù…Ù€Ù€Ù€Ù€Ù€Ù€Ù†</th>
            <th style="
    padding-left: 10px;
    padding-right: 10px;
    padding-top: 14px;
">Ø§Ù„ÙˆØµÙ€Ù€ÙˆÙ„ Ø¥Ù„Ù€Ù€Ù€Ù€Ù€Ù‰</th>
            <th style="
    width: 92px;
    padding-left: 9px;
    padding-right: 9px;
    height: 40px;
    padding-top: 10px;
    padding-bottom: 10px;
">Ø§Ù„Ø³Ø¹Ø± Ø°Ù‡Ù€Ø§Ø¨Ø§ ÙÙ€Ù‚Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ø·</th>
            <th style="
    width: 92px;
    padding-top: 10px;
    padding-bottom: 10px;
    padding-left: 9px;
    padding-right: 9px;
    height: 40px;
">Ø§Ù„Ø³Ù€Ù€Ø¹Ø± Ø°Ù‡Ù€Ù€Ø§Ø¨ Ùˆ Ø§Ù„Ø¹Ù€Ù€Ù€Ù€Ù€Ù€Ù€ÙˆØ¯Ø©</th>
            <th style="
    width: 75px;
    height: 40px;
    padding-left: 11px;
    padding-right: 11px;
">Ù…Ù€Ù€Ù€Ù„Ø§Ø­Ù€Ø¸Ù€Ø§Øª</th>
            <th class="delete-header">Ø­Ø°Ù</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>
    <div class="footer">
      Ù„Ù„Ø­Ø¬Ø² Ø§Ùˆ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ : <a href="tel:778878820">778878820 - 778878810</a>
    </div>
  </div>
  <script>
    function updateTimestamp() {
      const now = new Date();
      const year = now.getFullYear();
      const month = String(now.getMonth() + 1).padStart(2, '0');
      const day = String(now.getDate()).padStart(2, '0');
      const hours = now.getHours();
      const minutes = String(now.getMinutes()).padStart(2, '0');
      const ampm = now.getHours() >= 12 ? 'Ù…' : 'Øµ';
      const formattedHours = hours > 12 ? hours - 12 : (hours === 0 ? 12 : hours);
      document.getElementById("timestamp").textContent = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« : ${day}/${month}/${year} & Ø§Ù„Ø³Ø§Ø¹Ø©: [${String(formattedHours).padStart(2, '0')}:${minutes}] ${ampm}`;
    }
    function formatDate(dateString) {
      const date = new Date(dateString);
      const day = date.getDate();
      const month = date.getMonth() + 1;
      const year = date.getFullYear();
      return `${day}â€/${month}â€/${year}`;
    }
    function getDayName(dateString) {
      const date = new Date(dateString);
      const days = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
      return days[date.getDay()];
    }
    function makeEditable(element, type = 'text', value = '') {
      element.classList.remove('editable');
      element.style.cursor = 'default';
      let input;
      if (type === 'date') {
        input = document.createElement('input');
        input.type = 'date';
        const dateParts = value.split('/');
        const year = dateParts[2];
        const month = dateParts[1].padStart(2, '0');
        const day = dateParts[0].padStart(2, '0');
        input.value = `${year}-${month}-${day}`;
      } else if (type === 'number') {
        input = document.createElement('input');
        input.type = 'number';
        input.value = value.replace(' $', '').replace('-', '');
      } else {
        input = document.createElement('input');
        input.type = 'text';
        input.value = value === '-' ? '' : value;
      }
      input.style.width = '100%';
      input.style.padding = '10px';
      input.style.border = '2px solid #0055aa';
      input.style.borderRadius = '8px';
      input.style.textAlign = 'center';
      input.style.fontSize = '16px';
      element.innerHTML = '';
      element.appendChild(input);
      input.focus();
      input.addEventListener('blur', function() {
        let displayValue = input.value;
        if (type === 'date' && input.value) {
          const date = new Date(input.value);
          const formattedDate = formatDate(input.value);
          const dayName = getDayName(input.value);
          // Update the date cell
          element.textContent = formattedDate;
          // Update the day cell (previous cell)
          const dayCell = element.parentElement.children[0];
          dayCell.textContent = dayName;
        } else if (type === 'number') {
          displayValue = displayValue ? `${displayValue} $` : '-';
        } else {
          displayValue = displayValue || '-';
        }
        element.textContent = displayValue;
        element.classList.add('editable');
        element.style.cursor = 'pointer';
        updateTimestamp();
      });
      input.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          input.blur();
        }
      });
    }
    function addFlight() {
      const from = document.getElementById("from-city").value;
      const to = document.getElementById("to-city").value;
      const date = document.getElementById("flight-date").value;
      const oneWay = document.getElementById("one-way-price").value;
      const returnPrice = document.getElementById("return-price").value;
      const notes = document.getElementById("notes").value;
      const quantity = parseInt(document.getElementById("quantity").value) || 1;
      if (!from || !to || !date || !oneWay) {
        alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
        return;
      }
      const formattedDate = formatDate(date);
      const dayName = getDayName(date);
      const tbody = document.querySelector("#flights-table tbody");
      for (let i = 0; i < quantity; i++) {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="editable day-bold">${dayName}</td>
          <td class="editable date-bold">${formattedDate}</td>
          <td>${from}</td>
          <td>${to}</td>
          <td class="editable one-way">${oneWay} $</td>
          <td class="editable return">${returnPrice ? returnPrice + ' $' : '-'}</td>
          <td class="editable">${notes || '-'}</td>
          <td class="delete-column px-6 py-4 text-center"><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td>
        `;
        tbody.appendChild(row);
      }
      // Make all new cells editable
      const newEditableCells = tbody.querySelectorAll('.editable');
      newEditableCells.forEach(cell => {
        cell.addEventListener('click', function(e) {
          if (e.target === cell || e.target.classList.contains('editable')) {
            let type = 'text';
            let value = cell.textContent;
            if (cell.classList.contains('date-bold')) {
              type = 'date';
            } else if (cell.classList.contains('one-way') || cell.classList.contains('return')) {
              type = 'number';
              value = value.replace(' $', '').replace('-', '');
            } else if (cell.classList.contains('day-bold')) {
              type = 'text';
            }
            makeEditable(cell, type, value);
          }
        });
      });
      document.getElementById("from-city").value = "";
      document.getElementById("to-city").value = "";
      document.getElementById("flight-date").value = "";
      document.getElementById("one-way-price").value = "";
      document.getElementById("return-price").value = "";
      document.getElementById("notes").value = "";
      updateTimestamp();
    }
    function deleteRow(button) {
      if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø­Ù„Ø©ØŸ")) {
        const row = button.closest("tr");
        row.remove();
        updateTimestamp();
      }
    }
    function clearTable() {
      if (confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø±Ø­Ù„Ø§ØªØŸ")) {
        const tbody = document.querySelector("#flights-table tbody");
        tbody.innerHTML = "";
        updateTimestamp();
      }
    }
    async function downloadImage() {
      const controls = document.querySelector('.controls');
      const deleteHeader = document.querySelector('.delete-header');
      const deleteColumns = document.querySelectorAll('.delete-column');
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ±
      controls.style.display = 'none';
      deleteHeader.style.display = 'none';
      deleteColumns.forEach(col => col.style.display = 'none');
      const element = document.getElementById("print-area");
      try {
        const canvas = await html2canvas(element, { scale: 2, useCORS: true });
        const link = document.createElement("a");
        link.download = `Ø£Ø³Ø¹Ø§Ø±-Ø§Ù„Ø·ÙŠØ±Ø§Ù†-Ø®Ø§Ø·Ø±Ùƒ-${new Date().toLocaleDateString('ar-SA')}.png`;
        link.href = canvas.toDataURL("image/png");
        link.click();
      } catch (err) {
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©.");
        console.error(err);
      } finally {
        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø±Ø¶
        controls.style.display = '';
        deleteHeader.style.display = '';
        deleteColumns.forEach(col => col.style.display = '');
      }
    }
    function downloadText() {
      const rows = document.querySelectorAll("#flights-table tbody tr");
      if (rows.length === 0) {
        alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ØªÙ†Ø²ÙŠÙ„Ù‡Ø§.");
        return;
      }
      let textData = "Ø®Ø§Ø·Ø±Ùƒ Ù„Ù„Ø³ÙØ±ÙŠØ§Øª ÙˆØ§Ù„Ø³ÙŠØ§Ø­Ø© - Ø£Ø³Ø¹Ø§Ø± ØªØ°Ø§ÙƒØ± Ø§Ù„Ø·ÙŠØ±Ø§Ù†\n";
      textData += "============================================\n";
      textData += "Ø§Ù„ÙŠÙˆÙ…\tØ§Ù„ØªØ§Ø±ÙŠØ®\tÙ…Ù†\tØ¥Ù„Ù‰\tØ³Ø¹Ø± Ø§Ù„Ø°Ù‡Ø§Ø¨\tØ³Ø¹Ø± Ø§Ù„Ø°Ù‡Ø§Ø¨ ÙˆØ§Ù„Ø¹ÙˆØ¯Ø©\tÙ…Ù„Ø§Ø­Ø¸Ø§Øª\n";
      textData += "----\t------\t--\t--\t-----------\t------------------\t--------\n";
      rows.forEach(row => {
        const cells = row.querySelectorAll("td");
        const rowData = [
          cells[0].textContent.trim(),
          cells[1].textContent.trim(),
          cells[2].textContent.trim(),
          cells[3].textContent.trim(),
          cells[4].textContent.trim(),
          cells[5].textContent.trim(),
          cells[6].textContent.trim()
        ];
        textData += rowData.join("\t") + "\n";
      });
      textData += "\n============================================\n";
      textData += `ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«: ${document.getElementById("timestamp").textContent}\n`;
      textData += "Ù„Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±: 778878820 - 778878810";
      const blob = new Blob([textData], { type: "text/plain;charset=utf-8" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `Ø£Ø³Ø¹Ø§Ø±-Ø§Ù„Ø·ÙŠØ±Ø§Ù†-Ø®Ø§Ø·Ø±Ùƒ-${new Date().toLocaleDateString('ar-SA')}.txt`;
      link.click();
      URL.revokeObjectURL(link.href);
    }
    // Initialize editable cells
    document.addEventListener('DOMContentLoaded', function() {
      updateTimestamp();
      document.addEventListener('click', function(e) {
        const cell = e.target.closest('.editable');
        if (cell && !e.target.closest('input')) {
          let type = 'text';
          let value = cell.textContent;
          if (cell.classList.contains('date-bold')) {
            type = 'date';
          } else if (cell.classList.contains('one-way') || cell.classList.contains('return')) {
            type = 'number';
            value = value.replace(' $', '').replace('-', '');
          } else if (cell.classList.contains('day-bold')) {
            type = 'text';
          }
          makeEditable(cell, type, value);
        }
      });
    });
  </script>
</body>
</html>
